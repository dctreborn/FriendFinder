<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Friend Finder Survey</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="style.css">
 	<script src="https://code.jquery.com/jquery.js"></script>
 	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</head>
<body>
	<div class="container">
		<div class="jumbotron">
			<h1>Survey Questions</h1>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3>About You</h3>
			</div>
			<div class="panel-body">
				<h4>Name (required)</h4>
				<input type="text" class="form-control" placeholder="Name">
				<h4>Link to Photo (required)</h4>
				<input type="text" class="form-control" placeholder="Photo">
			</div>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3>Questions</h3>
				<h5>Rate each one from 1-5 (strongly disagree to strongly agree)</h5>
			</div>
			<div class="panel-body">
				<h4>Question 1</h4>
					<p>Food is important to me.</p>
					<select id="q1" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 2</h4>
					<p>Cooking is how I relax.</p>
					<select id="q2" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 3</h4>
					<p>I exercise to stay active.</p>
					<select id="q3" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 4</h4>
					<p>The night life is where it's at.</p>
					<select id="q4" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 5</h4>
					<p>I'm the life of the party.</p>
					<select id="q5" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 6</h4>
					<p>I like parties.</p>
					<select id="q6" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 7</h4>
					<p>I like unwinding in a quiet place.</p>
					<select id="q7" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 8</h4>
					<p>I like wandering unknown places.</p>
					<select id="q8" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 9</h4>
					<p>It's never my fault.</p>
					<select id="q9" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
				<hr>
				<h4>Question 10</h4>
					<p>I don't mind getting my hands dirty to get things done.</p>
					<select id="q10" class="form-control question">
					  <option value="1">1</option>
					  <option value="2">2</option>
					  <option value="3">3</option>
					  <option value="4">4</option>
					  <option value="5">5</option>
					</select>
			</div>

				<!-- Submit Button -->
				<button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
		 Submit</button>

				<hr>
			    <footer class="footer">
			      <div class="container">
			        <p><a href="/api/friends">API Friend List</a> | <a href="https://github.com/rukaroa/friendfinder">GitHub Repo</a></p>
			      </div>
			    </footer>

			</div>

			<!-- Modal -->
			<div id="resultsModal" class="modal fade" role="dialog">
			  <div class="modal-dialog">

			    <!-- Modal content-->
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal">&times;</button>
			        <h2 class="modal-title"><strong>Best Match</strong></h2>
			      </div>
			      <div class="modal-body">
			        <h2 id="matchName"></h2>
			        <img id="matchImg" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg" alt="">
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			      </div>
			    </div>

			  </div>
			</div>

			<script type="text/javascript">

			  	// Chosen CSS
			    var config = {
			      '.chosen-select'           : {},
			      '.chosen-select-deselect'  : {allow_single_deselect:true},
			      '.chosen-select-no-single' : {disable_search_threshold:10},
			      '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
			      '.chosen-select-width'     : {width:"95%"}
			    }
			    for (var selector in config) {
			      $(selector).chosen(config[selector]);
			    }

			    // Capture the form inputs 
			    $("#submit").on("click", function(){

			    	// Form validation
			    	function validateForm() {
					  var isValid = true;
					  $('.form-control').each(function() {
					    if ( $(this).val() === '' )
					        isValid = false;
					  });

					  $('.chosen-select').each(function() {

					  	if( $(this).val() === "")
					  		isValid = false
					  })
					  return isValid;
					}

					// If all required fields are filled
					if (validateForm() == true)
					{
						// Create an object for the user's data
				    	var userData = {
				    		name: $("#name").val(),
				    		photo: $("#photo").val(),
				    		scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val(), ]
				    	}


				    	// Grab the URL of the website
				    	var currentURL = window.location.origin;

				    	// AJAX post the data to the friends API. 
				    	$.post(currentURL + "/api/friends", userData, function(data){

				    		// Grab the result from the AJAX post so that the best match's name and photo are displayed.
				    		$("#matchName").text(data.name);
				    		$('#matchImg').attr("src", data.photo);

					    	// Show the modal with the best match 
					    	$("#resultsModal").modal('toggle');

				    	});
					}
					else
					{
						alert("Please fill out all fields before submitting!");
					}
			    	
			    	return false;
			    });
			</script>
		</div>
	</div>	
</body>
</html>